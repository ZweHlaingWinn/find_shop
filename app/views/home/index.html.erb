
<div id="map"></div>


<script>
    var markers = JSON.parse('<%= escape_javascript(@shopmarker)  %>')
    
    window.onload = function () {
        LoadMap();
    }
    function LoadMap() {
        //click icon show name
        var infoWindow = new google.maps.InfoWindow();

        var latlngbounds = new google.maps.LatLngBounds();
        var map = new google.maps.Map(document.getElementById("map"), {
                    center: {latitude: 13.756331, longitude: 100.501762},
                    zoom: 10,
                });
 
        for (var i = 0; i < markers.length; i++) {
            var data = markers[i]
            var shopLatLng = new google.maps.LatLng(data.latitude, data.longitude);
            var image = {
                url: data.category + ".png", 
                scaledSize: new google.maps.Size(20, 25), 
            }
            var marker = new google.maps.Marker({
                position: shopLatLng,
                map: map,
                icon: image,
            });
            (function (marker, data) {
                google.maps.event.addListener(marker, "click", function (e) {
                    infoWindow.setContent("<div id=content> <div id=siteNotice> </div> <p id=firstHeading class=firstHeading>" + data.name + "</p></div>");
                    infoWindow.open(map, marker);
                });
            })(marker, data);
            latlngbounds.extend(marker.position);
        }
        var bounds = new google.maps.LatLngBounds();
        
        map.setCenter(latlngbounds.getCenter());
        map.fitBounds(latlngbounds);
    }

</script>